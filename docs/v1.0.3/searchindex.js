Search.setIndex({"alltitles":{"API Reference":[[3,null]],"Basic Usage for Flexible Flash Attention":[[4,"basic-usage-for-flexible-flash-attention"]],"Basic Usage for MagiAttention":[[4,"basic-usage-for-magiattention"]],"Calculate Attention":[[3,"calculate-attention"]],"Compute Pad Size":[[3,"compute-pad-size"]],"Contents":[[1,null]],"Dispatch":[[3,"dispatch"]],"Dispatch Function":[[3,"dispatch-function"]],"Flexible Dispatch":[[3,"flexible-dispatch"]],"Flexible Flash Attention":[[3,"flexible-flash-attention"]],"Get Most Recent Key":[[3,"get-most-recent-key"]],"Get Position Ids":[[3,"get-position-ids"]],"Installation":[[2,null]],"MagiAttention documentation":[[1,null]],"Step1: Activate an NGC pytorch docker container":[[2,"step1-activate-an-ngc-pytorch-docker-container"]],"Step2: Install required packages":[[2,"step2-install-required-packages"]],"Step3: Install MagiAttention from source":[[2,"step3-install-magiattention-from-source"]],"Tutorial":[[4,null]],"Undispatch":[[3,"undispatch"]],"Undispatch Function":[[3,"undispatch-function"]],"User Guide":[[0,null],[0,null]],"Utility Functions":[[3,"utility-functions"]],"Varlen Dispatch":[[3,"varlen-dispatch"]]},"docnames":["guide","index","install","magi_api","tutorial"],"envversion":{"sphinx":65,"sphinx.domains.c":3,"sphinx.domains.changeset":1,"sphinx.domains.citation":1,"sphinx.domains.cpp":9,"sphinx.domains.index":1,"sphinx.domains.javascript":3,"sphinx.domains.math":2,"sphinx.domains.python":4,"sphinx.domains.rst":2,"sphinx.domains.std":2,"sphinx.ext.intersphinx":1,"sphinx.ext.todo":2},"filenames":["guide.md","index.md","install.md","magi_api.md","tutorial.md"],"indexentries":{"calc_attn() (in module magi_attention.api.magi_attn_interface)":[[3,"magi_attention.api.magi_attn_interface.calc_attn",false]],"compute_pad_size() (in module magi_attention.api.functools)":[[3,"magi_attention.api.functools.compute_pad_size",false]],"dispatch() (in module magi_attention.api.magi_attn_interface)":[[3,"magi_attention.api.magi_attn_interface.dispatch",false]],"flex_flash_attn_func() (in module magi_attention.functional.flex_flash_attn)":[[3,"magi_attention.functional.flex_flash_attn.flex_flash_attn_func",false]],"get_most_recent_key() (in module magi_attention.api.magi_attn_interface)":[[3,"magi_attention.api.magi_attn_interface.get_most_recent_key",false]],"get_position_ids() (in module magi_attention.api.magi_attn_interface)":[[3,"magi_attention.api.magi_attn_interface.get_position_ids",false]],"magi_attention.api":[[3,"module-magi_attention.api",false]],"magi_attn_flex_dispatch() (in module magi_attention.api.magi_attn_interface)":[[3,"magi_attention.api.magi_attn_interface.magi_attn_flex_dispatch",false]],"magi_attn_flex_key() (in module magi_attention.api.magi_attn_interface)":[[3,"magi_attention.api.magi_attn_interface.magi_attn_flex_key",false]],"magi_attn_varlen_dispatch() (in module magi_attention.api.magi_attn_interface)":[[3,"magi_attention.api.magi_attn_interface.magi_attn_varlen_dispatch",false]],"magi_attn_varlen_key() (in module magi_attention.api.magi_attn_interface)":[[3,"magi_attention.api.magi_attn_interface.magi_attn_varlen_key",false]],"module":[[3,"module-magi_attention.api",false]],"undispatch() (in module magi_attention.api.magi_attn_interface)":[[3,"magi_attention.api.magi_attn_interface.undispatch",false]]},"objects":{"magi_attention":[[3,0,0,"-","api"]],"magi_attention.api.functools":[[3,1,1,"","compute_pad_size"]],"magi_attention.api.magi_attn_interface":[[3,1,1,"","calc_attn"],[3,1,1,"","dispatch"],[3,1,1,"","get_most_recent_key"],[3,1,1,"","get_position_ids"],[3,1,1,"","magi_attn_flex_dispatch"],[3,1,1,"","magi_attn_flex_key"],[3,1,1,"","magi_attn_varlen_dispatch"],[3,1,1,"","magi_attn_varlen_key"],[3,1,1,"","undispatch"]],"magi_attention.functional.flex_flash_attn":[[3,1,1,"","flex_flash_attn_func"]]},"objnames":{"0":["py","module","Python module"],"1":["py","function","Python function"]},"objtypes":{"0":"py:module","1":"py:function"},"terms":{"":[3,4],"0":[3,4],"02":2,"1":[1,2,3,4],"10":3,"1024":4,"12288":4,"128":4,"12k":4,"15":3,"16384":4,"16k":4,"1d":3,"1st":4,"2":[3,4],"20":3,"2048":[3,4],"20480":4,"20k":4,"24576":4,"24k":4,"25":2,"28672":4,"28k":4,"2d":3,"2k":4,"2nd":4,"3":3,"30":3,"32":4,"32768":4,"32k":4,"4":3,"4096":[3,4],"48":4,"4k":4,"5":3,"512":[3,4],"64":3,"67108864":2,"8":4,"8192":4,"8k":4,"AND":3,"By":3,"For":3,"If":3,"In":3,"The":3,"To":3,"_":[3,4],"about":[3,4],"abov":3,"access":3,"achiev":1,"across":[1,3],"activ":[0,4],"addit":3,"affect":3,"aforement":4,"after":3,"aim":1,"alg":3,"align":3,"all":[2,3,4],"along":[3,4],"alreadi":3,"also":3,"alwai":4,"amount":3,"an":[0,3],"ani":3,"api":[0,1,4],"appli":3,"ar":[1,3],"arg":4,"argument":[3,4],"assum":4,"atom":3,"attent":[0,1],"attn":3,"attn_mask_typ":[3,4],"attn_type_map":[3,4],"attn_type_map_tensor":4,"attnmasktyp":[3,4],"attnoverlapmod":3,"attnrang":[3,4],"auto_range_merg":3,"automat":3,"awar":3,"backend":3,"balanc":[3,4],"bash":2,"basic":0,"becaus":3,"below":3,"better":[3,4],"bfloat16":4,"bidirect":3,"bin":2,"block":4,"block_siz":4,"blog":3,"bool":3,"both":3,"bother":[3,4],"bottom":3,"broad":1,"broader":1,"build":2,"cacul":3,"calc_attn":[3,4],"calcul":0,"call":3,"can":3,"care":[3,4],"case":3,"causal":[3,4],"cd":2,"chun_siz":3,"chunk":[3,4],"chunk_siz":[3,4],"clear":4,"clearup_dist_env":4,"clone":2,"column":3,"com":2,"combin":3,"command":2,"commit":1,"common":4,"commun":[1,3],"compelet":4,"complet":3,"comput":4,"compute_pad_s":[3,4],"config":[3,4],"consist":3,"contain":0,"container_mnt_root":2,"container_nam":2,"context":[1,3,4],"continu":1,"control":[3,4],"corr":3,"correct":4,"cp":[1,3,4],"cp_group_or_mesh":[3,4],"cp_size":[3,4],"cross":3,"cu_seqlen":3,"cu_seqlen_k":3,"cu_seqlen_q":3,"cu_seqlens_k":3,"cu_seqlens_q":3,"cuda":4,"cumul":3,"custom":4,"d":2,"data":[3,4],"decod":3,"default":[3,4],"defin":[3,4],"degre":3,"descript":3,"design":3,"determinist":3,"develop":3,"devic":[3,4],"devicemesh":3,"differ":3,"dim":[3,4],"dimens":4,"directli":3,"disabl":3,"disable_fwd_atomic_reduct":3,"dispatch":[0,4],"dispatch_config":3,"dispatchconfig":3,"dist":3,"dist_attn_config":3,"dist_attn_runtime_kei":3,"distattnconfig":3,"distattnruntimedict":3,"distattnruntimekei":3,"distattnruntimemgr":3,"distribut":[1,3,4],"divers":3,"divid":3,"divis":3,"do":3,"docker":0,"doe":3,"doesn":3,"don":3,"dtype":[3,4],"due":3,"dure":3,"e":[3,4],"each":[3,4],"easi":3,"either":4,"element":3,"els":3,"emb":4,"embed":4,"embed_dim":4,"empti":3,"enabl":3,"encod":3,"enhanc":1,"ensur":3,"enum":[3,4],"environ":[3,4],"etc":4,"even":3,"evenli":3,"exampl":[3,4],"excit":1,"exec":2,"exist":3,"exp":[3,4],"explain":3,"explan":3,"extern":3,"factor":4,"fals":3,"faster":3,"featur":1,"ffa":4,"final":3,"first":3,"flag":3,"flash":0,"flash_attn_varlen":3,"flashattent":3,"flex":3,"flex_flash_attn":3,"flex_flash_attn_func":[3,4],"flexibl":[0,1],"flexible_flash_attent":3,"float":3,"float32":3,"follow":[3,4],"forward":3,"found":3,"fp32":4,"from":[0,3,4],"from_rang":[3,4],"full":[3,4],"function":[0,4],"functool":3,"further":3,"g":[3,4],"gather":3,"gener":[1,3],"get_most_recent_kei":3,"get_position_id":3,"git":2,"github":[2,3],"global":3,"gpt":3,"gpu":[2,3,4],"gqa":4,"granular":[3,4],"group":3,"guid":1,"ha":3,"have":[3,4],"head":4,"head_dim":[3,4],"helper":4,"here":2,"heterogen":1,"hidden_s":3,"hold":[3,4],"horizon":1,"host":2,"host_mnt_root":2,"howev":3,"http":[2,3],"i":[1,3,4],"imag":2,"implement":3,"import":4,"improv":1,"includ":3,"inconsist":3,"inform":3,"init":2,"initi":4,"inner":[3,4],"input":[3,4],"insert":3,"inspir":3,"instal":[0,1],"int":3,"int32":[3,4],"interfac":[3,4],"intersect":3,"invers":3,"invok":3,"involv":1,"io":[2,3],"ipc":2,"irregular":3,"is_k_permut":3,"is_q_permut":3,"is_same_sourc":3,"isol":2,"k":[3,4],"k_proj":4,"k_project":3,"k_rang":[3,4],"k_ranges_tensor":4,"kei":4,"kernel":[1,3],"known":4,"last":3,"layer":4,"left":3,"len":4,"length":[3,4],"level":1,"like":[1,3,4],"limit":3,"linear":[1,4],"list":3,"llama":3,"load":[3,4],"local":[3,4],"local_k":[3,4],"local_ls":4,"local_out":[3,4],"local_q":[3,4],"local_rank":4,"local_v":[3,4],"local_x":[3,4],"log":[3,4],"logic":3,"long":[1,3],"look":4,"loss":[3,4],"lse":[3,4],"magi":1,"magi_attent":[3,4],"magi_attn_flex_dispatch":[3,4],"magi_attn_flex_kei":3,"magi_attn_interfac":3,"magi_attn_kernel":3,"magi_attn_runtime_kei":4,"magi_attn_varlen_dispatch":3,"magi_attn_varlen_kei":3,"magi_runtime_kei":4,"magiattent":[0,3],"mai":[3,4],"mainli":3,"make":3,"mani":[3,4],"map":3,"mask":[1,3,4],"matmul":4,"max":4,"max_num_chunk":3,"max_seqlen_k":[3,4],"max_seqlen_q":[3,4],"maximum":3,"meanwhil":3,"mechan":1,"memlock":2,"mention":3,"merg":3,"mesh":3,"meta":[3,4],"might":[3,4],"min_chunk_s":3,"minheapdispatchalg":3,"mix":3,"modal":3,"mode":3,"moment":4,"more":[3,4],"multi":3,"multipl":[3,4],"multiprocessor":3,"name":[2,3],"nccl":3,"need":[3,4],"network":2,"new":1,"new_group":3,"ngc":0,"nn":4,"non":3,"none":4,"norm":4,"note":[2,3,4],"now":[3,4],"num_head":3,"num_heads_kv":4,"num_heads_q":4,"num_rang":3,"num_tokens_k":3,"num_tokens_kv":3,"num_tokens_q":3,"num_tokens_v":3,"number":[3,4],"numer":3,"nvcr":2,"nvidia":2,"object":3,"obtain":3,"one":[3,4],"onli":[3,4],"onlin":4,"op":3,"oper":4,"option":3,"order":4,"org":[2,3],"origin":3,"other":[3,4],"our":3,"out":[3,4],"output":[3,4],"overlap":3,"overlap_config":3,"overlapalgtyp":3,"overlapconfig":3,"overview":1,"packag":0,"pad":4,"pad_siz":[3,4],"parallel":[1,3,4],"paramet":3,"part":3,"partial":4,"particularli":1,"pass":3,"perform":[1,3,4],"permut":3,"pip":2,"point":3,"postion":3,"privileg":2,"process":3,"processgroup":3,"project":[3,4],"provid":3,"py3":2,"pytorch":0,"q":[3,4],"q_proj":4,"q_project":3,"q_rang":[3,4],"q_ranges_tensor":4,"qkv":4,"queri":[3,4],"quickli":3,"r":[2,3],"rais":3,"randn":[3,4],"rang":[1,3],"rank":[3,4],"re":3,"receiv":3,"recommend":3,"recov":3,"recurs":2,"reduct":[3,4],"ref":3,"refer":[0,1],"releas":2,"repres":3,"requir":[0,3],"requires_grad":[3,4],"research":1,"reserv":3,"respect":1,"result":3,"return":[3,4],"right":[3,4],"rope":[3,4],"row":3,"run":[2,4],"safe":4,"same":3,"sampl":4,"sandai":[2,3],"scalabl":1,"scale":3,"scenario":1,"script":4,"second":4,"see":3,"seed":4,"self":3,"semant":3,"seq_dim":3,"seq_len":3,"seqlen":[3,4],"seqlen_k":3,"seqlen_q":3,"seqln":3,"sequenc":3,"set":[3,4],"setup_dist_env":4,"shape":3,"share":3,"should":[3,4],"shuffl":4,"similar":3,"simul":4,"sinc":3,"size":[1,4],"slice":4,"slide":3,"sm":3,"sm_margin":3,"so":4,"softcap":3,"softmax":[3,4],"softmax_scal":[3,4],"some":[3,4],"sourc":[0,3],"spars":3,"specifi":3,"sqrt":[3,4],"stabil":3,"stack":2,"stai":1,"start":3,"static":3,"step1":0,"step2":0,"step3":0,"still":3,"str":3,"strategi":1,"stream":3,"strongli":3,"submodul":2,"subsequ":3,"suitabl":1,"sum":[3,4],"support":[1,3],"t":3,"t5":3,"task":1,"tensor":[3,4],"tenspr":3,"thei":3,"them":3,"therefor":3,"thi":3,"through":3,"token":[3,4],"top":3,"torch":[3,4],"torchrun":4,"total":3,"total_k":3,"total_out":[3,4],"total_q":3,"total_seqlen":[3,4],"total_seqlen_k":[3,4],"total_seqlen_q":[3,4],"total_v":3,"train":1,"transform":3,"troubl":3,"true":[3,4],"tune":1,"tupl":3,"tutori":[0,1],"two":3,"txt":2,"type":[1,3],"ulimit":2,"ultra":1,"under":3,"undispatch":[0,4],"unexpect":3,"uniform":3,"unmask":4,"unpad":[3,4],"unpermut":3,"until":4,"up":4,"updat":2,"us":[3,4],"usag":0,"user":[1,3,4],"usual":3,"util":[0,4],"v":[2,3,4],"v_proj":4,"v_project":3,"valu":[3,4],"valueerror":3,"varieti":1,"ve":3,"version":2,"video":1,"view":4,"visual":3,"w":3,"wai":3,"we":[1,3,4],"when":3,"where":4,"whether":3,"which":[1,3,4],"while":[1,3,4],"wide":1,"window":3,"wise":[3,4],"world_group":4,"world_siz":4,"x":[3,4],"you":[3,4]},"titles":["User Guide","MagiAttention documentation","Installation","API Reference","Tutorial"],"titleterms":{"activ":2,"an":2,"api":3,"attent":[3,4],"basic":4,"calcul":3,"comput":3,"contain":2,"content":1,"dispatch":3,"docker":2,"document":1,"flash":[3,4],"flexibl":[3,4],"from":2,"function":3,"get":3,"guid":0,"id":3,"instal":2,"kei":3,"magiattent":[1,2,4],"most":3,"ngc":2,"packag":2,"pad":3,"posit":3,"pytorch":2,"recent":3,"refer":3,"requir":2,"size":3,"sourc":2,"step1":2,"step2":2,"step3":2,"tutori":4,"undispatch":3,"usag":4,"user":0,"util":3,"varlen":3}})