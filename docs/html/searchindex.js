Search.setIndex({"alltitles":{"API Reference":[[0,null]],"Api Reference":[[2,"api-reference"]],"AttnRange":[[2,"attnrange"]],"MagiAttention documentation":[[1,null]],"Simple Test For AttnRanges":[[2,null]]},"docnames":["api","index","ranges"],"envversion":{"sphinx":65,"sphinx.domains.c":3,"sphinx.domains.changeset":1,"sphinx.domains.citation":1,"sphinx.domains.cpp":9,"sphinx.domains.index":1,"sphinx.domains.javascript":3,"sphinx.domains.math":2,"sphinx.domains.python":4,"sphinx.domains.rst":2,"sphinx.domains.std":2,"sphinx.ext.intersphinx":1,"sphinx.ext.todo":2},"filenames":["api.md","index.md","ranges.md"],"indexentries":{"append() (magi_attention.common.ranges.attnranges method)":[[2,"magi_attention.common.ranges.AttnRanges.append",false]],"attnrange (class in magi_attention.common.range)":[[2,"magi_attention.common.range.AttnRange",false]],"attnranges (class in magi_attention.common.ranges)":[[2,"magi_attention.common.ranges.AttnRanges",false]],"check_valid() (magi_attention.common.range.attnrange method)":[[2,"magi_attention.common.range.AttnRange.check_valid",false]],"check_valid() (magi_attention.common.ranges.attnranges method)":[[2,"magi_attention.common.ranges.AttnRanges.check_valid",false]],"chunk() (magi_attention.common.ranges.attnranges method)":[[2,"magi_attention.common.ranges.AttnRanges.chunk",false]],"clear_empty() (magi_attention.common.ranges.attnranges method)":[[2,"magi_attention.common.ranges.AttnRanges.clear_empty",false]],"diff_by() (magi_attention.common.range.attnrange method)":[[2,"magi_attention.common.range.AttnRange.diff_by",false]],"end (magi_attention.common.range.attnrange property)":[[2,"magi_attention.common.range.AttnRange.end",false]],"end (magi_attention.common.ranges.attnranges property)":[[2,"magi_attention.common.ranges.AttnRanges.end",false]],"extend() (magi_attention.common.ranges.attnranges method)":[[2,"magi_attention.common.ranges.AttnRanges.extend",false]],"find_hole_ranges() (magi_attention.common.ranges.attnranges method)":[[2,"magi_attention.common.ranges.AttnRanges.find_hole_ranges",false]],"find_overlap_ranges() (magi_attention.common.ranges.attnranges method)":[[2,"magi_attention.common.ranges.AttnRanges.find_overlap_ranges",false]],"from_cu_seqlens() (magi_attention.common.ranges.attnranges static method)":[[2,"magi_attention.common.ranges.AttnRanges.from_cu_seqlens",false]],"from_range() (magi_attention.common.range.attnrange static method)":[[2,"magi_attention.common.range.AttnRange.from_range",false]],"from_ranges() (magi_attention.common.ranges.attnranges static method)":[[2,"magi_attention.common.ranges.AttnRanges.from_ranges",false]],"insert() (magi_attention.common.ranges.attnranges method)":[[2,"magi_attention.common.ranges.AttnRanges.insert",false]],"intersect() (magi_attention.common.range.attnrange method)":[[2,"magi_attention.common.range.AttnRange.intersect",false]],"intersect_size() (magi_attention.common.range.attnrange method)":[[2,"magi_attention.common.range.AttnRange.intersect_size",false]],"intersect_size() (magi_attention.common.ranges.attnranges method)":[[2,"magi_attention.common.ranges.AttnRanges.intersect_size",false]],"intersect_size_with() (magi_attention.common.ranges.attnranges method)":[[2,"magi_attention.common.ranges.AttnRanges.intersect_size_with",false]],"is_cu_seqlens() (magi_attention.common.ranges.attnranges method)":[[2,"magi_attention.common.ranges.AttnRanges.is_cu_seqlens",false]],"is_empty() (magi_attention.common.range.attnrange method)":[[2,"magi_attention.common.range.AttnRange.is_empty",false]],"is_empty() (magi_attention.common.ranges.attnranges method)":[[2,"magi_attention.common.ranges.AttnRanges.is_empty",false]],"is_merged() (magi_attention.common.ranges.attnranges method)":[[2,"magi_attention.common.ranges.AttnRanges.is_merged",false]],"is_non_overlap() (magi_attention.common.ranges.attnranges method)":[[2,"magi_attention.common.ranges.AttnRanges.is_non_overlap",false]],"is_overlap_with() (magi_attention.common.range.attnrange method)":[[2,"magi_attention.common.range.AttnRange.is_overlap_with",false]],"is_sorted() (magi_attention.common.ranges.attnranges method)":[[2,"magi_attention.common.ranges.AttnRanges.is_sorted",false]],"is_subrange_of() (magi_attention.common.range.attnrange method)":[[2,"magi_attention.common.range.AttnRange.is_subrange_of",false]],"is_valid() (magi_attention.common.range.attnrange method)":[[2,"magi_attention.common.range.AttnRange.is_valid",false]],"is_valid() (magi_attention.common.ranges.attnranges method)":[[2,"magi_attention.common.ranges.AttnRanges.is_valid",false]],"is_valid_cu_seqlens() (in module magi_attention.common.ranges)":[[2,"magi_attention.common.ranges.is_valid_cu_seqlens",false]],"magi_attention.common":[[2,"module-magi_attention.common",false]],"make_range_local() (magi_attention.common.ranges.attnranges method)":[[2,"magi_attention.common.ranges.AttnRanges.make_range_local",false]],"make_ranges_local() (magi_attention.common.ranges.attnranges method)":[[2,"magi_attention.common.ranges.AttnRanges.make_ranges_local",false]],"max_seqlen (magi_attention.common.ranges.attnranges property)":[[2,"magi_attention.common.ranges.AttnRanges.max_seqlen",false]],"merge() (magi_attention.common.ranges.attnranges method)":[[2,"magi_attention.common.ranges.AttnRanges.merge",false]],"module":[[2,"module-magi_attention.common",false]],"offset() (magi_attention.common.range.attnrange method)":[[2,"magi_attention.common.range.AttnRange.offset",false]],"points (magi_attention.common.ranges.attnranges property)":[[2,"magi_attention.common.ranges.AttnRanges.points",false]],"pop() (magi_attention.common.ranges.attnranges method)":[[2,"magi_attention.common.ranges.AttnRanges.pop",false]],"seqlen (magi_attention.common.range.attnrange property)":[[2,"magi_attention.common.range.AttnRange.seqlen",false]],"size (magi_attention.common.ranges.attnranges property)":[[2,"magi_attention.common.ranges.AttnRanges.size",false]],"sort() (magi_attention.common.ranges.attnranges method)":[[2,"magi_attention.common.ranges.AttnRanges.sort",false]],"start (magi_attention.common.range.attnrange property)":[[2,"magi_attention.common.range.AttnRange.start",false]],"start (magi_attention.common.ranges.attnranges property)":[[2,"magi_attention.common.ranges.AttnRanges.start",false]],"to_cu_seqlens() (magi_attention.common.ranges.attnranges method)":[[2,"magi_attention.common.ranges.AttnRanges.to_cu_seqlens",false]],"to_naive_range() (magi_attention.common.range.attnrange method)":[[2,"magi_attention.common.range.AttnRange.to_naive_range",false]],"to_naive_ranges() (magi_attention.common.ranges.attnranges method)":[[2,"magi_attention.common.ranges.AttnRanges.to_naive_ranges",false]],"to_tensor() (magi_attention.common.ranges.attnranges method)":[[2,"magi_attention.common.ranges.AttnRanges.to_tensor",false]],"total_seqlen (magi_attention.common.ranges.attnranges property)":[[2,"magi_attention.common.ranges.AttnRanges.total_seqlen",false]],"truncate() (magi_attention.common.range.attnrange method)":[[2,"magi_attention.common.range.AttnRange.truncate",false]],"truncate() (magi_attention.common.ranges.attnranges method)":[[2,"magi_attention.common.ranges.AttnRanges.truncate",false]],"union() (magi_attention.common.range.attnrange method)":[[2,"magi_attention.common.range.AttnRange.union",false]],"union_size() (magi_attention.common.range.attnrange method)":[[2,"magi_attention.common.range.AttnRange.union_size",false]],"union_size() (magi_attention.common.ranges.attnranges method)":[[2,"magi_attention.common.ranges.AttnRanges.union_size",false]],"union_size_with() (magi_attention.common.ranges.attnranges method)":[[2,"magi_attention.common.ranges.AttnRanges.union_size_with",false]]},"objects":{"magi_attention":[[2,0,0,"-","common"]],"magi_attention.common.range":[[2,1,1,"","AttnRange"]],"magi_attention.common.range.AttnRange":[[2,2,1,"","check_valid"],[2,2,1,"","diff_by"],[2,3,1,"","end"],[2,2,1,"","from_range"],[2,2,1,"","intersect"],[2,2,1,"","intersect_size"],[2,2,1,"","is_empty"],[2,2,1,"","is_overlap_with"],[2,2,1,"","is_subrange_of"],[2,2,1,"","is_valid"],[2,2,1,"","offset"],[2,3,1,"","seqlen"],[2,3,1,"","start"],[2,2,1,"","to_naive_range"],[2,2,1,"","truncate"],[2,2,1,"","union"],[2,2,1,"","union_size"]],"magi_attention.common.ranges":[[2,1,1,"","AttnRanges"],[2,4,1,"","is_valid_cu_seqlens"]],"magi_attention.common.ranges.AttnRanges":[[2,2,1,"","append"],[2,2,1,"","check_valid"],[2,2,1,"","chunk"],[2,2,1,"","clear_empty"],[2,3,1,"","end"],[2,2,1,"","extend"],[2,2,1,"","find_hole_ranges"],[2,2,1,"","find_overlap_ranges"],[2,2,1,"","from_cu_seqlens"],[2,2,1,"","from_ranges"],[2,2,1,"","insert"],[2,2,1,"","intersect_size"],[2,2,1,"","intersect_size_with"],[2,2,1,"","is_cu_seqlens"],[2,2,1,"","is_empty"],[2,2,1,"","is_merged"],[2,2,1,"","is_non_overlap"],[2,2,1,"","is_sorted"],[2,2,1,"","is_valid"],[2,2,1,"","make_range_local"],[2,2,1,"","make_ranges_local"],[2,3,1,"","max_seqlen"],[2,2,1,"","merge"],[2,3,1,"","points"],[2,2,1,"","pop"],[2,3,1,"","size"],[2,2,1,"","sort"],[2,3,1,"","start"],[2,2,1,"","to_cu_seqlens"],[2,2,1,"","to_naive_ranges"],[2,2,1,"","to_tensor"],[2,3,1,"","total_seqlen"],[2,2,1,"","truncate"],[2,2,1,"","union_size"],[2,2,1,"","union_size_with"]]},"objnames":{"0":["py","module","Python module"],"1":["py","class","Python class"],"2":["py","method","Python method"],"3":["py","property","Python property"],"4":["py","function","Python function"]},"objtypes":{"0":"py:module","1":"py:class","2":"py:method","3":"py:property","4":"py:function"},"terms":{"":2,"0":2,"1":[1,2],"10":2,"15":2,"18":2,"2":1,"20":2,"25":2,"3":1,"30":2,"4":1,"5":[1,2],"A":2,"If":2,"It":2,"The":[1,2],"Their":2,"These":2,"To":1,"With":1,"_":2,"_rang":2,"_ranges_":2,"achiev":1,"across":1,"actual":2,"adapt":1,"add":2,"addit":2,"address":1,"adjac":2,"advanc":2,"aim":1,"algorithm":2,"all":[1,2],"alreadi":2,"an":1,"ani":2,"api":1,"append":2,"ar":[1,2],"ascend":2,"assum":2,"attent":[1,2],"attn":2,"attn_rang":2,"axi":2,"backward":1,"balanc":1,"base":[1,2],"been":2,"between":2,"block":1,"bool":2,"broad":1,"calcul":2,"can":2,"cast":1,"causal":1,"challeng":1,"check":2,"check_valid":2,"choos":2,"chunk":2,"chunk_siz":2,"class":2,"classifi":1,"clear_empti":2,"combin":1,"common":2,"commun":1,"complex":[1,2],"comput":[1,2],"contain":2,"context":1,"continu":2,"convent":2,"convert":2,"cover":2,"cp":1,"cpu":2,"cu_seqlen":2,"data":1,"dataclass":2,"default":2,"describ":[1,2],"design":2,"devic":2,"diff_bi":2,"differ":2,"dispatch":1,"dist":2,"distinguish":2,"divers":1,"duplic":2,"dure":1,"e":2,"each":2,"effici":1,"element":2,"elimin":1,"empti":2,"end":2,"ensur":1,"equal":2,"etc":2,"exampl":2,"explan":2,"extend":2,"extrem":1,"facilit":2,"fals":2,"featur":1,"ffa":1,"find":2,"find_hole_rang":2,"find_overlap_rang":2,"flash":1,"flexibl":1,"follow":2,"forward":1,"from_cu_seqlen":2,"from_rang":2,"g":2,"gener":[1,2],"global":2,"group":1,"guarante":2,"have":2,"here":2,"heterogen":1,"highli":1,"hole_rang":2,"host":2,"host_global_sorted_unperm_ranges_per_rank":2,"i":[1,2],"idx":2,"index":2,"indexerror":2,"indic":2,"insert":2,"instead":2,"int":2,"intersect":2,"intersect_s":2,"intersect_size_with":2,"interv":2,"introduc":1,"involv":1,"is_cu_seqlen":2,"is_empti":2,"is_merg":2,"is_non_overlap":2,"is_other_merg":2,"is_overlap_with":2,"is_self_merg":2,"is_sort":2,"is_subrange_of":2,"is_valid":2,"is_valid_cu_seqlen":2,"item":2,"kernel":1,"larg":1,"last":2,"len":2,"length":[1,2],"level":1,"like":[1,2],"line":2,"linear":1,"list":2,"load":1,"local":2,"local_rang":2,"log":2,"long":1,"m":2,"magi":1,"magi_attent":2,"mai":2,"major":1,"make_range_loc":2,"make_ranges_loc":2,"manag":2,"map":2,"mask":1,"max_seqlen":2,"maximum":2,"mean":2,"memori":[1,2],"merg":2,"method":2,"million":1,"model":1,"must":2,"n":2,"name":2,"neither":2,"none":2,"nor":2,"note":2,"number":2,"o":2,"object":2,"occur":2,"offset":2,"optim":1,"order":2,"origin":2,"other":2,"other_attn_rang":2,"other_attn_range\u5728self\u7684local_ranges\u4e2d\u7684\u4f4d\u7f6e":2,"out":2,"overhead":1,"overlap":[1,2],"overlap_rang":2,"overview":1,"pack":1,"pad":1,"pair":2,"parallel":1,"paramet":2,"part":2,"particularli":1,"partit":1,"pattern":1,"per_rank":2,"per_stag":2,"perm":2,"permut":2,"pnp":1,"point":2,"pop":2,"posit":2,"prefix_offset":2,"present":1,"preserv":2,"primit":1,"prohibit":1,"properti":2,"propos":1,"python":2,"qualifi":2,"rais":2,"rang":[1,2],"reach":1,"reduc":1,"redund":1,"refer":1,"relationship":2,"releas":1,"remot":2,"remote_local_merged_perm_ranges_per_stag":2,"remov":2,"repo":2,"repres":2,"requir":2,"respect":1,"result":[1,2],"return":2,"rule":2,"same":2,"satisfi":2,"scalabl":1,"scale":1,"scenario":1,"scope":2,"self":2,"seq_len":2,"seqlen":2,"sequenc":2,"set":2,"shard":1,"sinc":2,"size":[1,2],"so":2,"solver":1,"sort":2,"stabl":2,"start":2,"static":2,"statu":1,"storag":2,"store":2,"str":2,"subtract":2,"suffix":2,"suitabl":1,"sum":2,"support":1,"sweep":2,"tangent":2,"task":1,"techniqu":1,"tensor":2,"test":1,"th":2,"thi":[1,2],"time":2,"timelin":1,"to_cu_seqlen":2,"to_local_rang":2,"to_naive_rang":2,"to_tensor":2,"togeth":1,"token":1,"total":2,"total_seqlen":2,"train":1,"true":2,"truncat":2,"tupl":2,"two":1,"type":[1,2],"ultra":1,"under":1,"union":2,"union_s":2,"union_size_with":2,"unord":2,"unperm":2,"up":1,"us":2,"valu":2,"varieti":1,"variou":2,"video":1,"we":1,"what":2,"when":2,"where":2,"whether":2,"which":[1,2],"while":1,"wide":1,"without":2,"\u5141\u8bb8\u901a\u8fc7\u53ef\u9009\u7684\u4f4d\u7f6e\u53c2\u6570\u6765\u622a\u65ad":2,"\u5219\u8ba1\u7b97prefix_offset":2,"\u53ef\u80fd\u8fd4\u56de\u4e00\u4e2a\u7a7a\u7684rang":2,"\u5982\u679cprefix_offset\u4e3anon":2,"\u5982\u679c\u6709\u622a\u65ad\u64cd\u4f5c":2,"\u5c06other_attn_range\u6620\u5c04\u5230self_ranges\u5bf9\u5e94\u7684local_ranges\u4e2d":2,"\u5e76\u8fd4\u56deother_attn_range\u5728local_ranges\u4e2d\u7684\u4f4d\u7f6e":2,"\u662f\u5426self\u5df2\u7ecfmerg":2,"\u9700\u8981\u88ab\u8f6c\u6362\u7684other_attn_rang":2},"titles":["API Reference","MagiAttention documentation","Simple Test For AttnRanges"],"titleterms":{"For":2,"api":[0,2],"attnrang":2,"document":1,"magiattent":1,"refer":[0,2],"simpl":2,"test":2}})