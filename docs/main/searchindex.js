Search.setIndex({"alltitles":{"AOT":[[0,"aot"]],"API Reference":[[4,null]],"Basic Usage for Flex-Flash-Attention":[[5,"basic-usage-for-flex-flash-attention"]],"Basic Usage for MagiAttention":[[5,"basic-usage-for-magiattention"]],"Calculate Attention":[[4,"calculate-attention"]],"Compute Pad Size and Padding":[[4,"compute-pad-size-and-padding"]],"Contents":[[2,null]],"Dispatch":[[4,"dispatch"]],"Dispatch Function":[[4,"dispatch-function"]],"Environment Variables":[[0,null]],"Flexible Dispatch":[[4,"flexible-dispatch"]],"Flexible Flash Attention":[[4,"flexible-flash-attention"]],"For Build":[[0,"for-build"]],"For Correctness":[[0,"for-correctness"]],"For Debug":[[0,"for-debug"]],"For Performance":[[0,"for-performance"]],"Get Most Recent Key":[[4,"get-most-recent-key"]],"Get Position Ids":[[4,"get-position-ids"]],"Infer Sliding Window Masks":[[4,"infer-sliding-window-masks"]],"Infer Varlen Masks":[[4,"infer-varlen-masks"]],"Installation":[[3,null]],"JIT":[[0,"jit"]],"MagiAttention documentation":[[2,null]],"QuickStart":[[5,null]],"Step1: Activate an NGC pytorch docker container":[[3,"step1-activate-an-ngc-pytorch-docker-container"]],"Step2: Install required packages":[[3,"step2-install-required-packages"]],"Step3: Install MagiAttention from source":[[3,"step3-install-magiattention-from-source"]],"Undispatch":[[4,"undispatch"]],"Undispatch Function":[[4,"undispatch-function"]],"User Guide":[[1,null],[1,null]],"Utility Functions":[[4,"utility-functions"]],"Varlen Dispatch":[[4,"varlen-dispatch"]]},"docnames":["env_variables","guide","index","install","magi_api","quickstart"],"envversion":{"sphinx":66,"sphinx.domains.c":3,"sphinx.domains.changeset":1,"sphinx.domains.citation":1,"sphinx.domains.cpp":9,"sphinx.domains.index":1,"sphinx.domains.javascript":3,"sphinx.domains.math":2,"sphinx.domains.python":4,"sphinx.domains.rst":2,"sphinx.domains.std":2,"sphinx.ext.intersphinx":1,"sphinx.ext.todo":2},"filenames":["env_variables.md","guide.md","index.md","install.md","magi_api.md","quickstart.md"],"indexentries":{"magi_attention.api":[[4,"module-magi_attention.api",false]],"module":[[4,"module-magi_attention.api",false]]},"objects":{"magi_attention":[[4,0,0,"-","api"]]},"objnames":{"0":["py","module","Python module"]},"objtypes":{"0":"py:module"},"terms":{"12k":5,"16k":5,"1st":5,"20k":5,"24k":5,"28k":5,"2k":5,"2nd":5,"32k":5,"4k":5,"8k":5,"After":4,"And":0,"Below":0,"By":4,"For":[1,4],"If":[0,4],"In":[0,4],"NOT":0,"So":0,"The":[0,4],"Then":4,"This":[0,4],"To":[0,4],"We":[0,2],"When":4,"You":[4,5],"_":5,"abov":4,"accept":0,"access":4,"accord":4,"accumul":0,"achiev":2,"across":[0,2,4,5],"activ":[0,1,5],"affect":4,"aforement":5,"aim":2,"algorithm":0,"all_reduc":5,"all_reduce_op":5,"along":[0,4,5],"alreadi":4,"also":[0,4],"alway":[0,5],"ani":0,"anywher":0,"api":[1,2,5],"appli":[0,4,5],"apply_pad":4,"arg":5,"argument":[4,5],"assum":5,"attent":[0,1,2],"attn":[0,4],"attn_mask_typ":5,"attn_type_map":5,"attn_type_map_tensor":5,"attnmasktyp":[0,5],"attnrang":[0,5],"automat":0,"avail":0,"avg":[0,5],"avoid":0,"awar":4,"back":0,"backend":0,"backward":[0,5],"balanc":5,"base":[0,4],"bash":3,"basic":1,"batch_siz":4,"better":5,"bfloat16":5,"bi_caus":4,"bias":0,"bin":3,"block":5,"block_siz":5,"bother":5,"broad":2,"broader":2,"build":[1,3],"built":0,"bwd":0,"c":0,"cach":0,"calc_attn":[4,5],"calcul":1,"call":4,"can":[0,4],"care":5,"case":[4,5],"cast":0,"causal":[4,5],"cd":3,"ceil":0,"check":0,"choos":3,"chunk":[4,5],"chunk_siz":[4,5],"clear":5,"clearup_dist_env":5,"clone":3,"code":0,"collect":0,"com":3,"combin":4,"comm":[0,5],"command":[0,3,5],"commit":2,"common":[0,5],"communic":[0,4],"communiti":2,"compat":[0,3],"compelet":5,"compil":0,"complet":4,"comput":[0,5],"compute_pad_s":[4,5],"config":5,"configur":0,"consid":0,"consist":4,"contain":[1,4],"container_mnt_root":3,"container_nam":3,"context":[2,5],"continu":2,"control":[0,5],"core":0,"correct":1,"correspond":4,"cp":[0,2,5],"cp_group_or_mesh":5,"cp_size":5,"cpu":0,"creat":4,"cu12":0,"cu_seqlen":4,"cuda":[0,5],"cuda_device_max_connect":0,"custom":[0,5],"d":3,"data":[0,5],"debug":1,"decompos":4,"decomposit":4,"dedic":4,"default":[0,5],"defin":[0,4,5],"descript":[0,4],"design":4,"detail":[0,5],"determinist":0,"develop":0,"devic":5,"differ":4,"dim":[0,4,5],"dimens":[4,5],"direct":4,"directori":0,"disabl":0,"dispatch":[1,5],"dist":[0,5],"dist_attn_func":0,"dist_attn_runtime_dict":0,"distribut":[2,4,5],"divers":4,"divid":4,"divis":4,"dk":[0,5],"dk_proj":5,"doc":5,"docker":1,"don":5,"doubl":0,"dp":[0,5],"dq":[0,5],"dq_proj":5,"dsink":5,"dsink_all_reduce_op":5,"dtype":[0,5],"dure":[0,4],"dv":[0,5],"dv_proj":5,"dx":5,"dynam":0,"e":[0,5],"easi":4,"either":5,"elimin":0,"els":5,"emb":5,"embed":5,"embed_dim":5,"enabl":0,"enhanc":2,"ensur":4,"enum":5,"env":0,"environ":[1,2,5],"etc":[0,5],"even":[0,4],"everywher":0,"exact":0,"exampl":5,"excit":2,"exec":3,"execut":0,"exist":[0,4],"experiment":0,"extens":0,"extra":0,"f":5,"facilit":4,"fall":0,"featur":[0,2],"feed":0,"fetch":0,"ffa":[0,5],"file":0,"fill":4,"find":0,"first":4,"flag":0,"flash":1,"flashattent":4,"flatten":0,"flex":1,"flex_flash_attn_func":5,"flexibl":[1,2],"flexible_flash_attent":4,"flexible_flash_attention_utils_cuda":0,"float32":5,"follow":[4,5],"forc":0,"form":4,"forward":0,"found":0,"fp32":[0,5],"fp64":0,"framework":[0,5],"from_rang":5,"fsdp":[0,5],"full":[0,4,5],"function":[1,5],"futur":0,"fwd":0,"g":[0,5],"general":2,"generat":[0,2,4],"get":0,"get_most_recent_key":4,"get_position_id":4,"git":3,"github":3,"given":4,"global":[0,4],"global_sink":5,"gpu":[4,5],"gpus":[3,4,5],"gqa":[0,5],"grad":5,"gradient":[0,5],"granular":5,"group":[0,5],"guid":2,"handl":[0,4,5],"hardwar":0,"has_sink":5,"head":[0,5],"head_dim":5,"helper":5,"heterogen":2,"hierarch":0,"high":0,"higher":0,"hold":5,"home":0,"horizon":2,"host":3,"host_mnt_root":3,"howev":[0,4],"https":3,"implement":[0,4],"import":5,"improv":[0,2],"includ":[0,4],"inconsist":4,"increas":0,"infer_attn_mask_from_cu_seqlen":4,"infer_attn_mask_from_sliding_window":4,"infer_varlen_mask_from_batch":4,"inform":[0,4],"init":3,"initi":5,"inner":5,"input":[0,4,5],"insid":0,"inspir":4,"instal":[0,1,2],"int32":5,"inter":0,"inter_nod":0,"interfac":[4,5],"intra_nod":0,"inv_caus":4,"invalid":4,"invok":4,"involv":[0,2],"io":3,"ipc":3,"irregular":4,"isol":3,"job":0,"k":5,"k_proj":5,"k_rang":[4,5],"k_ranges_tensor":5,"kernel":[0,2,4],"key":[0,5],"know":0,"known":5,"layer":[0,5],"learnabl":0,"leav":0,"len":5,"length":4,"less":0,"let":0,"level":2,"lib":0,"like":[0,2,4,5],"limit":[0,4],"linear":[0,2,5],"list":0,"llama":4,"lm":[0,5],"load":5,"local":[4,5],"local_k":5,"local_ls":5,"local_out":5,"local_q":5,"local_rank":5,"local_v":5,"local_x":5,"logic":4,"long":2,"look":5,"loss":[4,5],"lse":[0,4,5],"magi":[0,2],"magi_attent":[0,5],"magi_attention_backward_high_precision_reduc":0,"magi_attention_build_debug":0,"magi_attention_build_verbos":0,"magi_attention_cpp_backend":0,"magi_attention_deterministic_mod":0,"magi_attention_dist_attn_runtime_dict_s":0,"magi_attention_dsink_all_reduce_op":[0,5],"magi_attention_ffa_backward_sm_margin":0,"magi_attention_ffa_forward_sm_margin":0,"magi_attention_flatten_head_group":0,"magi_attention_force_jit_build":0,"magi_attention_forward_high_precision_reduc":0,"magi_attention_hierarchical_comm":0,"magi_attention_native_grpcol":0,"magi_attention_no_build_cach":0,"magi_attention_prebuild_ffa":0,"magi_attention_prebuild_ffa_job":0,"magi_attention_profile_mod":0,"magi_attention_qo_comm":0,"magi_attention_sanity_check":0,"magi_attention_sdpa_backend":0,"magi_attention_skip_ffa_utils_build":0,"magi_attention_skip_magi_attn_comm_build":0,"magi_attention_skip_magi_attn_ext_build":0,"magi_attention_workspace_bas":0,"magi_attn_comm":0,"magi_attn_ext":0,"magi_attn_flex_dispatch":[4,5],"magi_attn_flex_key":4,"magi_attn_runtime_key":5,"magi_attn_varlen_dispatch":4,"magi_attn_varlen_key":4,"magiattent":[0,1,4],"main":[0,4],"major_vers":3,"make":4,"make_flex_key_for_new_mask_after_dispatch":4,"make_varlen_key_for_new_mask_after_dispatch":4,"mani":[0,5],"mask":[2,5],"mask_typ":4,"masktyp":4,"master_addr":5,"master_port":5,"match":5,"math":0,"matmul":5,"max_job":0,"may":[0,5],"meanwhil":4,"mechan":[0,2],"megatron":[0,5],"memlock":3,"mention":4,"merg":4,"mesh":0,"meta":[4,5],"might":[0,4,5],"minor_vers":3,"mode":0,"model":0,"modul":0,"moment":5,"moreov":4,"mqa":0,"multipl":[4,5],"name":[3,4],"nativ":0,"necessari":4,"need":[0,4,5],"neglig":0,"network":3,"new":[2,4],"ngc":1,"ninja":0,"nn":[0,5],"nnode":5,"node":0,"node_rank":5,"non":0,"none":[0,5],"norm":5,"note":[3,5],"now":[0,5],"nproc_per_nod":5,"num_cpu_cor":0,"num_heads_kv":5,"num_heads_q":5,"num_local_rank":5,"num_nod":5,"number":[0,4,5],"nvcc":0,"nvcc_thread":0,"nvcr":3,"nvidia":[0,3],"nvshmem":0,"nvshmem_dir":0,"o":0,"obtain":4,"often":4,"one":[3,4,5],"onli":[0,5],"op":[0,4,5],"oper":5,"optim":0,"option":[0,5],"order":5,"org":3,"origin":4,"others":0,"otherwis":0,"output":[0,5],"overhead":0,"overlap":0,"overview":2,"packag":1,"pad":5,"pad_at_dim":4,"pad_siz":[4,5],"parallel":[0,2,5],"paramet":[0,4,5],"part":4,"partial":[0,5],"particular":2,"pass":[4,5],"path":[0,3],"pcie":0,"perform":[1,2,4,5],"permut":4,"pip":3,"pleas":0,"popular":0,"pre":0,"precis":0,"privileg":3,"process":[0,4],"product":0,"profil":0,"project":[4,5],"provid":[0,4],"py3":3,"python":[0,5],"pytorch":1,"q":[0,5],"q_proj":5,"q_rang":[4,5],"q_ranges_tensor":5,"qkv":5,"qo":0,"queri":[0,4,5],"queue":0,"quick":4,"quickstart":[1,2],"r":3,"rais":5,"randn":5,"randn_lik":5,"rang":2,"rank":[0,5],"re":4,"receiv":4,"recommend":4,"recov":4,"recurs":3,"reduc":0,"reduceop":5,"reduct":[0,5],"redund":0,"ref_block_s":0,"refer":[1,2],"region":4,"regist":0,"regular":0,"relat":[0,4],"releas":3,"remot":0,"remov":0,"repeat":0,"replic":0,"repres":4,"requir":[0,1,4],"requires_grad":5,"research":2,"reshap":4,"respect":2,"restrict":0,"result":4,"return":4,"reus":4,"right":5,"rope":[4,5],"run":[3,5],"s":[0,4,5],"safe":5,"sampl":5,"sandai":3,"saniti":0,"save":0,"scalabl":2,"scale":0,"scenario":[0,2],"script":5,"script_path":5,"sdpa":0,"see":[0,5],"seed":5,"segment":4,"seq_len":4,"seqlen":[4,5],"seqlen_sink":5,"set":[0,5],"setup_dist_env":5,"shape":4,"show":0,"shuffl":5,"similar":[0,4],"simul":5,"sinc":[0,4,5],"sink":[0,5],"size":[0,2,5],"skip":[0,5],"slice":[4,5],"sms":0,"softcap":5,"softmax_scal":5,"sole":0,"solut":[0,4],"solver":0,"sometim":0,"sourc":[0,1],"specif":4,"specifi":[0,3,5],"speed":0,"split":0,"sqrt":5,"squash_batch_dim":4,"stack":3,"standalon":5,"start":4,"stay":2,"step1":1,"step2":1,"step3":1,"strategi":2,"stream":0,"strong":4,"structur":0,"style":4,"submodul":3,"subsequ":4,"suitabl":2,"sum":[0,5],"support":[0,2,4],"suppos":0,"switch":0,"symbol":0,"system":0,"t":5,"task":2,"temporari":0,"tensor":[0,4,5],"test":0,"therefor":4,"thread":0,"three":4,"thus":0,"toggl":0,"token":[4,5],"torch":5,"torchrun":5,"total_out":5,"total_seqlen":[4,5],"total_seqlen_k":[4,5],"total_seqlen_q":[4,5],"trade":0,"traffic":0,"train":[0,2,4,5],"troubl":4,"true":5,"tune":2,"tupl":4,"two":4,"txt":[0,3],"type":[2,4],"ulimit":3,"ultra":2,"undispatch":[1,5],"unexpect":4,"unknown":5,"unless":[0,5],"unmask":5,"unpad":[4,5],"unpad_at_dim":4,"unsur":4,"updat":[0,3],"usag":[0,1],"use":[0,4,5],"user":[0,2,5],"usual":5,"util":[0,1,5],"v":[3,5],"v_proj":5,"valu":[0,4,5],"valueerror":5,"variabl":[1,2,5],"varieti":2,"ve":4,"verbos":0,"version":3,"video":2,"view":5,"w":0,"want":4,"weight":5,"whether":5,"whole":[0,5],"whose":0,"wide":2,"will":[0,4,5],"window_s":4,"wise":5,"within":[0,4],"work":0,"workspac":0,"world_group":5,"world_siz":5,"x":[0,4,5]},"titles":["Environment Variables","User Guide","MagiAttention documentation","Installation","API Reference","QuickStart"],"titleterms":{"For":0,"Most":4,"activ":3,"aot":0,"api":4,"attent":[4,5],"basic":5,"build":0,"calcul":4,"comput":4,"contain":3,"content":2,"correct":0,"debug":0,"dispatch":4,"docker":3,"document":2,"environ":0,"flash":[4,5],"flex":5,"flexibl":4,"function":4,"get":4,"guid":1,"id":4,"infer":4,"instal":3,"jit":0,"key":4,"magiattent":[2,3,5],"mask":4,"ngc":3,"packag":3,"pad":4,"perform":0,"posit":4,"pytorch":3,"quickstart":5,"recent":4,"refer":4,"requir":3,"size":4,"slide":4,"sourc":3,"step1":3,"step2":3,"step3":3,"undispatch":4,"usag":5,"user":1,"util":4,"variabl":0,"varlen":4,"window":4}})